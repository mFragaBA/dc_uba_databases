<!DOCTYPE HTML>
<html lang="es" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Apuntes de Bases de Datos - 2c2022</title>
        <meta name="robots" content="noindex" />
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduccion.html">Introduccion</a></li><li class="chapter-item expanded affix "><li class="part-title">Primer Parcial</li><li class="chapter-item expanded "><a href="teoricas/index.html"><strong aria-hidden="true">1.</strong> Teórica</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="teoricas/17_08.html"><strong aria-hidden="true">1.1.</strong> Teórica - 17/08</a></li><li class="chapter-item expanded "><a href="teoricas/24_08.html"><strong aria-hidden="true">1.2.</strong> Teórica - 24/08</a></li></ol></li><li class="chapter-item expanded "><a href="practicas/index.html"><strong aria-hidden="true">2.</strong> Práctica</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="practicas/19_08.html"><strong aria-hidden="true">2.1.</strong> Práctica - 19/08</a></li></ol></li><li class="chapter-item expanded "><a href="guias/index.html"><strong aria-hidden="true">3.</strong> Guías de Ejercicios</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="guias/g1.html"><strong aria-hidden="true">3.1.</strong> Guía de Ejercicios 1</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Segundo Parcial</li><li class="spacer"></li><li class="chapter-item expanded affix "><a href="misc/contributors.html">Contributors</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Apuntes de Bases de Datos - 2c2022</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/mFragaBA/dc_uba_databases" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introducción"><a class="header" href="#introducción">Introducción</a></h1>
<p>Este es un apunte sobre la clase Bases de Datos de la Universidad de
Buenos Aires dada en el segundo cuatrimestre de 2022.</p>
<p>No es un apunte oficial, ni tiene la función de serlo y no se
recomienda usar para estudiar para los parciales. A pesar de eso,
espero que les pueda servir de ayuda. Cualquier sugerencia o
corrección es bienvenida.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="teórica"><a class="header" href="#teórica">Teórica</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="teórica---1708"><a class="header" href="#teórica---1708">Teórica - 17/08</a></h1>
<p>Se definió el concepto de <strong>DER</strong> (<strong>D</strong>iagramas <strong>E</strong>ntidad <strong>R</strong>elación) describe la interrelación interrelated de cosas de interés dentro del alcance del dominio de un problema.</p>
<p>Algunos conceptos a utilizar</p>
<ul>
<li>Entidad: Objeto relevante para el sistema. Tiene sentido tenerla cuando tiene características propias. Se representa con un cuadrado</li>
<li>Atributo: Cualquier característica relevante de la entidad propia. Se representa con un círculo
<ul>
<li>Atributo simple: Atributo sin características especiales</li>
<li>Atributo identificatorio: Identificar una instancia unívocamente</li>
<li>Atributo compuesto: Aquel que se puede dividir</li>
<li>Atributo multivariado: Cuando podria ser mas de uno</li>
</ul>
</li>
<li>Interrelaciones: Vínculo entre dos entidades. Se representa con un rombo. Contiene varios aspectos:
<ul>
<li>Interrelaciones identificatorias.</li>
<li>Cardinalidad: tiene que ser una relación ACTUAL. Explica la cantidad de relaciones que se pueden dar
<ul>
<li>1-1</li>
<li>1-n</li>
<li>n-m</li>
</ul>
</li>
</ul>
</li>
<li>Participación:
<ul>
<li>Parcial: Si existe alguno que puede no cumplir la relación</li>
<li>Completa: Si todos cumplen con la relación</li>
</ul>
</li>
<li>Relaciones ternarias: Se necesitan las 3 identidades al mismo tiempo para que la relación funcione. Es bastante útil pero aparece muy poco</li>
<li>Agregación: Vincular una interrelación con una identidad. Además esta vinculación tiene que ser temporalmente posterior con respecto a la interrelación. Se denota con un rectángulo conteniendo a la interrelación y sus entidades vinculadas</li>
<li>Jerarquías de Especialización: Cada subentidad &quot;hereda&quot; todas las interrelaciones y atributos de la superentidad. No puede existir un elemento en una subentidad que no figure en la superentidad
<ul>
<li>Cobertura total: Cada elemento de la superentidad debe estar en al menos una de las subentidades</li>
<li>Cobertura parcial: PUede haber elementos de la superentidad que no estén en ninguno de las subentidades</li>
<li>Jerarquías disjuntas: Cada elemento de la superentidad está a lo sumo en una subentidad</li>
<li>Jerarquías con solapamiento: Los elementos de la superentidad pueden estar en más de una subentidad</li>
</ul>
</li>
</ul>
<p>Pongo un resúmen del primer capítulo de <em>Database Systems:
The Complete Book</em> y del capítulo 2 del <em>Principles of Database and
Knowledge Base Systems</em></p>
<h2 id="database-systems-the-complete-book"><a class="header" href="#database-systems-the-complete-book">Database Systems: The Complete Book</a></h2>
<ul>
<li>Sucintamente, una base de datos es una colección de información que
se mantiene por un período de tiempo (por lo general largo).</li>
<li>Es una colección de datos que es manejada por un DBMS. Este tiene
que permitir y/o asegurar:
<ol>
<li><strong>crear</strong> nuevas bases de datos y <strong>especificar</strong> sus <strong>schemas</strong></li>
<li>hacer <strong>consultas y modificaciones</strong> sobre los datos con un <em>query language</em> o <em>data-manipulation language</em></li>
<li>almacenar grandes cantidades de información con acceso eficiente para las operaciones de <strong>2</strong></li>
<li><strong>persistencia/durabilidad</strong> de la información: o sea que se pueda recuperar la data ante fallas</li>
<li><strong>Aislamiento</strong> y <strong>Atomicidad</strong> de operaciones (o transacciones como se ve más adelante)</li>
</ol>
</li>
</ul>
<p>... (Un poco de historia)</p>
<h3 id="overview-de-un-dbms"><a class="header" href="#overview-de-un-dbms">Overview de un DBMS</a></h3>
<p><img src="teoricas/./img/dbms_outline.png" alt="outline de un DBMS" /></p>
<p>Hay 2 tipos de usuarios de la base de datos:</p>
<ul>
<li>Usuarios y aplicaciones</li>
<li>El administrador de la base de datos</li>
</ul>
<p>Los comandos que uno y otro ejecutan toman distintos flujos dentro del
dbms aunque comparten subsistemas en común.</p>
<h3 id="data-definition-language-commands"><a class="header" href="#data-definition-language-commands">Data-Definition Language Commands</a></h3>
<p>El administrador usa un <em>DDL</em> (Data Definition Language) para definir
la estructura y constraints de las tablas. Estas instrucciones las
parsea un procesdor de DDLs y se envían el <em>execution engine</em>, y hacia
los index/file/record managers.</p>
<h3 id="procesamiento-de-queries"><a class="header" href="#procesamiento-de-queries">Procesamiento de Queries</a></h3>
<p>El usuario en cambio usa un <em>DML</em> (Data Manipulation Language) para
armar consultas que modifican o extraen información de la base de
datos. Estas consultas las atienden dos subsistemas:</p>
<ul>
<li><strong>Query</strong>: El primer subsistema consiste en el <em>query compiler +
execution engine + buffer manger</em>, y se encarga de la respuesta en
sí de la query.</li>
<li><strong>Transacciones</strong>: Las transacciones son operaciones que se tienen
que realizar de forma atómica y aisladas unas de otras (da lo mismo
si ejecutan al mismo tiempo que si no), y a su vez estas tienen que
poder ser persistidas. El subsistema que se encarga de procesar
transacciones entonces está compuesto por:
<ul>
<li>Un <em>scheduler</em>, para garantizar atomicidad y aislamiento</li>
<li>Un <em>logging &amp; recovery manager</em> para la persistencia de las
transacciones</li>
</ul>
</li>
</ul>
<h3 id="manejo-de-almacenamiento-y-buffers"><a class="header" href="#manejo-de-almacenamiento-y-buffers">Manejo de almacenamiento y buffers</a></h3>
<p>A esto lo componen dos piezas:</p>
<ul>
<li>El <em>storage manager</em>, que sirve de interfaz entre el disco y el resto del DBMS</li>
<li>El <em>buffer manager</em>, que maneja la memoria principal (RAM) organizándola en buffers en los que se cargan:
<ul>
<li>Data</li>
<li>Metadata</li>
<li>Log Records</li>
<li>Estadísticas</li>
<li>Índices</li>
</ul>
</li>
</ul>
<h3 id="procesamiento-de-transacciones"><a class="header" href="#procesamiento-de-transacciones">Procesamiento de transacciones</a></h3>
<p>El subsistema que procesa transacciones se encarga de 3 tareas:</p>
<ol>
<li><strong>logging</strong>, en el que se escribe un log en disco cada cambio en la
base de datos. Esto sirve para garantizar persistencia de las
transacciones. El <em>log manager</em> usa alguna política para que en
conjunto con el <em>recovery manager</em> se pueda restaurar la DB a un
estado consistente en caso de fallas.</li>
<li><strong>concurrency control</strong>, manejado por el <em>schedular</em> que mantiene
locks sobre los recursos.</li>
<li><strong>deadlock resolution</strong>. De esto se encarga el <em>transaction
manager</em>, cancelando algunas transacciones hasta que se liberan los
recursos necesarios como para continuar con la ejecución.</li>
</ol>
<p><strong>Propiedades ACID:</strong></p>
<ul>
<li>A de <em>atomicity</em> de la ejecución de transacciones.</li>
<li>I de <em>isolation</em> ya que las transacciones se tienen que ejecutar
como si ninguna otra se haya ejecutado en el medio</li>
<li>D de <em>durability</em> ya que las transacciones no deben perderse</li>
<li>C de <em>consistencia</em> (ojo, con el surgimiento de bases de datos
distribuidas/sistemas distribuidos, se fue transicionando a otros
esquemas en donde no necesariamente se garantiza consistencia si no
algo un poco más débil. Para más info buscar sobre <strong>CAP theorem</strong>)</li>
</ul>
<h3 id="query-processor"><a class="header" href="#query-processor">Query Processor</a></h3>
<p>Al <em>query processor</em> lo componen dos partes:</p>
<ol>
<li>El <em>query compiler</em>, que consiste de un parser, preprocessor y un
optimizer para las queries y genera un <strong>query plan</strong>.</li>
<li>El <em>execution engine</em> al que le llegan los query plans y tiene que
llevarlos a cabo.</li>
</ol>
<h2 id="principles-of-database-and-knowledge-base-systems-ch-2"><a class="header" href="#principles-of-database-and-knowledge-base-systems-ch-2">Principles of Database and Knowledge Base Systems (ch. 2)</a></h2>
<div style="break-before: page; page-break-before: always;"></div><h1 id="teórica---2408"><a class="header" href="#teórica---2408">Teórica - 24/08</a></h1>
<p>Repaso:</p>
<ul>
<li>Qué es una entidad? Un objeto relevante para mi problema</li>
<li>Qué es un atributo? Una característica relevante de una entidad</li>
<li>Una interrelación? Una relación entre dos entidades</li>
</ul>
<p>Había quedado algo pendiente: las bases de datos relacionales se crearon en el 68' (Edgar Cobb)</p>
<blockquote>
<p>Todas las bd relacionales no eran relacionales de verdad</p>
</blockquote>
<p>Propuso un gran avance para lo que era ese momento:</p>
<ul>
<li>
<p>Hasta ese momento había cobol</p>
</li>
<li>
<p>Para guardar los datos, guardaban los datos en un csv casi</p>
<ul>
<li>Estaba todo muy pegado a la parte física
<ul>
<li>Tengo que saber dónde estaba el archivo, el formato, la cantidad de campos, etc.</li>
</ul>
</li>
</ul>
</li>
<li>
<p>El avance de Cobb es separar en &quot;capas&quot;</p>
</li>
<li>
<p>Vistas - Externo</p>
<ul>
<li>Independencia Lógica: El usuario final puede consumir los datos sin saber dónde están, ni en qué tabla.
<ul>
<li>Ej: La afip puede cambiar todo el sistema y vos seguir viendo el mismo ticket</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Tablas - Conceptual</p>
<ul>
<li>Los que hacen desarrollo suelen estar a este nivel</li>
<li>No necesito saber cuántos campos tiene la tabla</li>
<li>Independencia física</li>
</ul>
</li>
<li>
<p>disco - Interno (DBA) </p>
<ul>
<li>sabe dónde están los archivos, el formato, etc</li>
</ul>
</li>
</ul>
<p>Algo relacionado a la idea: Data as a Service</p>
<ul>
<li>Los datos tienen mucha complejidad</li>
<li>Cada vez se trata de que esa lógica esté más aislada</li>
</ul>
<h2 id="modelo-relacional"><a class="header" href="#modelo-relacional">Modelo Relacional</a></h2>
<p>1 Tabla = 1 Relación</p>
<ul>
<li><code>R(A, B, C, D)</code> (Los dominios, a.k.a atributos)</li>
<li>\[R \subset DOM(A) \times DOM(B) \times DOM(C) \times DOM(D) \]</li>
<li>R es un conjunto</li>
<li>\[{(a, b), (a, b)} = {(a, b)}\]
<ul>
<li>o sea que <strong>no tengo dos registros iguales</strong></li>
<li>una relación <strong>siempre admite clave</strong>
<ul>
<li>como las bases de ese momento no obligan a crear claves
primarias entonces las bases de datos de ese momento no eran
relacionales posta</li>
</ul>
</li>
</ul>
</li>
<li>No puedo asumir que los datos están guardados en un orden
<ul>
<li>oracle guarda los datos físicos según primary key, sin embargo eso es una desición de implementación. El modelo no te obliga a hacer eso</li>
<li>Puedo ordenar al recuperar la data</li>
</ul>
</li>
</ul>
<h3 id="restricciones-de-integridad"><a class="header" href="#restricciones-de-integridad">Restricciones de Integridad</a></h3>
<p>recuerdo: esquema == la estructura de la base de datos</p>
<p>La base de datos va a chequear esto <strong>SIEMPRE</strong>. Rebota todo lo que no
lo cumpla. Por eso es importante transladar todo lo posible al
esquema.</p>
<ul>
<li>De dominio
<ul>
<li>tipo de datos</li>
<li>check constraint (ej, rango)</li>
<li>Nullidad
<ul>
<li>Null es <strong>NADA</strong></li>
</ul>
</li>
</ul>
</li>
<li>De clave
<ul>
<li>Unicidad
<ul>
<li>Super Clave</li>
<li>Clave Candidata (Clave Primaria) (Unicidad + Minimilidad) 
<ul>
<li>La DB no implementa Minimilidad, no tiene forma de verificar si lo que le digo es mínimo o no</li>
<li>Minimilidad = No le sobran campos, no depende del tamaño</li>
</ul>
</li>
</ul>
</li>
<li>Foránea</li>
</ul>
</li>
</ul>
<p>\[ 
R(A_1,\dots,A_n) \\
T \subseteq {A_1,\dots,A_n} \\
\]</p>
<p>T es SC de R sii
\[
t_1[T] = t_2[T] \implies t_1=t_2
\]</p>
<p>T es CC de R sii</p>
<ul>
<li>T es SC</li>
<li>No existe una clave S contenida en T tal que S es SC</li>
</ul>
<p>warning: No borrar en cascada</p>
<h3 id="pasaje-de-der-a-tabla"><a class="header" href="#pasaje-de-der-a-tabla">Pasaje de DER a tabla</a></h3>
<p>El pasaje es automático. Hay que seguir las siguientes reglas nomás:</p>
<ol>
<li>Cada entidad tiene 1 tabla</li>
<li>Todas las relaciones <code>M:N</code> tienen una tabla</li>
<li>Si tengo una <code>1:N</code>, va del lado del N</li>
<li>En una ternaria <code>N:M:1</code>, creo tabla y pongo como PKs la clave de la <code>N</code> y la de la <code>M</code></li>
</ol>
<p>En el ejemplo de las diapos:</p>
<ul>
<li>Alumno
<ul>
<li>LU(PK)</li>
<li>Calle</li>
<li>Nro</li>
<li>Piso</li>
<li>Depto</li>
</ul>
</li>
</ul>
<p>Podría definir un tipo compuesto con calle, nro, piso, depto. Puedo
reutilizarlo también en otras tablas.</p>
<ul>
<li>Materia
<ul>
<li>Código(PK)</li>
<li>Nombre</li>
<li>legajo (FK - Profesor)</li>
</ul>
</li>
</ul>
<p>Como profesor es parcial, lo pongo en materia porque toda materia
tiene un profesor (un profesor capaz que no tiene materia)</p>
<ul>
<li>Curso
<ul>
<li>Código (PK)(FK - materia)</li>
<li>Turno (PK)</li>
</ul>
</li>
</ul>
<p>Es <strong>una sóla primary</strong>, pero es compuesta por ser entidad débil.
Cuando uno define las FK tiene que decir de qué tabla son.</p>
<ul>
<li>MailAlumno
<ul>
<li>LU (PK) (FK - alumno)</li>
<li>email (PK)</li>
</ul>
</li>
</ul>
<p>Los atributos multivaluados necesitan ir a una tabla aparte</p>
<ul>
<li>Profesor
<ul>
<li>legajo(PK)(FK - Profesor)</li>
</ul>
</li>
</ul>
<p>Es una especialización de Docente, así que hereda la clave de docente</p>
<ul>
<li>
<p>Docente</p>
<ul>
<li>legajo (PK)</li>
</ul>
</li>
<li>
<p>Rol</p>
<ul>
<li>id_rol(PK)</li>
</ul>
</li>
</ul>
<p>Tengo las entidades y los atributos, me faltan las interrelaciones</p>
<ul>
<li>Rindió
<ul>
<li>LU (PK) (FK - Alumno)</li>
<li>Código (PK) (FK - Materia)</li>
<li>FechaExamen (PK)</li>
</ul>
</li>
</ul>
<p>Acá tres atributos conforman la PK</p>
<ul>
<li>Quiere Dictar
<ul>
<li>legajo (FK - Profesor)</li>
<li>código (FK - Materia)</li>
</ul>
</li>
</ul>
<p>Por eso necesitaba la especialización, porque con esto restrinjo a tener un profesor</p>
<ul>
<li>Dicta
<ul>
<li>legajo (PK) (FK - Docente)</li>
<li>id_rol (FK - Rol)</li>
<li>código (PK) (FK - Curso)</li>
<li>turno (PK) (FK - Curso)</li>
</ul>
</li>
</ul>
<p>código + turno forman la FK de Curso, y la PK se forma con las de las <code>N:M</code> pero no la <code>1</code>
Ahora Dicta si tiene FK del docente</p>
<p>Ejercicio: Cómo hago cuando tengo agregación? Usar el ejemplo de Curso, Materia, Encuesta</p>
<ul>
<li>La PK es el id_encuesta</li>
<li>El linkeo va en la tabla de Encuesta</li>
<li>La FK se forma con el legajo y el código</li>
<li>La FK es Fk de la interrelación Cursa (tiene sentido porque en una
agregación estoy considerando la interrelación como una entidad)</li>
</ul>
<h2 id="lenguajes-de-consulta"><a class="header" href="#lenguajes-de-consulta">Lenguajes de Consulta</a></h2>
<p>Recuerdo: DML - Data Manipulation Language</p>
<p>Existen 3 lenguajes para este problema</p>
<ul>
<li>AR
<ul>
<li>SQL es una implementación de Álgebra Relacional</li>
</ul>
</li>
<li>CRT</li>
<li>CRD</li>
</ul>
<h3 id="Álgebra-relacional"><a class="header" href="#Álgebra-relacional">Álgebra Relacional</a></h3>
<p>las ops de AR <strong>tienen que ser cerradas</strong> respecto al dominio original</p>
<p>Ops Unarias:</p>
<ul>
<li>proyección
<ul>
<li>Recupero un/unos campo/s de una tabla</li>
<li>\[\Pi_{legajo}(ALUMNO)\]</li>
<li>Es el <code>SELECT DISTINCT</code> (caro) de SQL.</li>
</ul>
</li>
<li>selección
<ul>
<li>recupera registros que cumplan una propiedad determinada</li>
<li>traigo los alumnos cuyo código de carrera sea A: \[\sigma_{codCarrera = &quot;A&quot;}(ALUMNO)\]</li>
</ul>
</li>
<li>renombre
<ul>
<li>Es el <code>AS</code> de SQL</li>
<li>De campos<!-- - \\[\phi_{codCarrera = "A"}(ALUMNO)\\] -->
</li>
<li>De relaciones<!-- - \\[\phi_{codCarrera = "A"}(ALUMNO)\\] -->
</li>
</ul>
</li>
</ul>
<p>ej: legajo de los alumnos que cursan la carrera A
\[\Pi_{legajo, codCarrera}(\sigma_{codCarrera = &quot;A&quot;}(ALUMNO))\]</p>
<p>Ops Binarias:</p>
<ul>
<li>Operaciones sobre relaciones &quot;Union Compatible&quot;
<ul>
<li>Tienen que compartir los mismos campos (nombre y tipo)</li>
<li><strong>Unión</strong></li>
<li><strong>Intersección</strong></li>
<li><strong>Diferencia</strong></li>
<li>De qué me sirve? Puedo separar en &quot;partes la query&quot; y tomar uniones de cada parte</li>
</ul>
</li>
<li>Otras Operaciones
<ul>
<li><strong>Producto Cartesiano</strong></li>
<li><strong>Natual Join</strong>: junto dos relaciones por un campo en común</li>
<li><strong>Outer Join</strong>: Me permite asegurar que me traigo todos los registros de una de las dos tablas aunque no matcheen</li>
<li>También tengo <strong>Full Outer Join</strong></li>
<li><strong>División</strong>: me permite obtener todos los registros que tienen un valor que aparece con todos los valores del conjunto que divide
<ul>
<li>Esta no está en SQL</li>
<li>El de arriba Siempre tiene que tener un campo más que el de abajo</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>EJ Joins: &quot;nombre (del alumno) y legajo de las materias que aprobó por lo menos un alumno&quot;
nota: No pongan joins de cosas que no van a usar</p>
<p>Ej División: Nombre de los alumnos que aprobaron todas las materias de su carrera</p>
<ul>
<li>Agarro todas las materias aprobadas por el alumno y lo divido por todas las que cursó</li>
</ul>
<h3 id="cálculo-relacional-de-tuplas-crt"><a class="header" href="#cálculo-relacional-de-tuplas-crt">Cálculo Relacional de Tuplas (CRT)</a></h3>
<ul>
<li>Más en términos de proposiciones</li>
<li>fórmulas
<ul>
<li>atómicas
<ul>
<li>R E Rel</li>
<li>R.a op S.b</li>
<li>R.a op constante o constante op R.a</li>
</ul>
</li>
<li>Cuantificadores</li>
<li>query: {t / p(t)}</li>
</ul>
</li>
<li>Inseguridad del CRT/CRD
<ul>
<li>potencialmente puede devolverte un conjunto infinito</li>
<li>{t \ not p(t)}</li>
<li>para solucionarlo forzando a que el resultado pertenezca al dominio/tabla madre</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="práctica"><a class="header" href="#práctica">Práctica</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="práctica---1908"><a class="header" href="#práctica---1908">Práctica - 19/08</a></h1>
<h2 id="presentación"><a class="header" href="#presentación">Presentación</a></h2>
<ul>
<li>2 parciales
<ul>
<li>1er parcial
<ul>
<li>DER/MER</li>
<li>Normalización</li>
<li>AR CRT</li>
</ul>
</li>
<li>2do parcial
<ul>
<li>concurrencia y recuperabilidad</li>
<li>noSQL</li>
</ul>
</li>
</ul>
</li>
<li>Laboratorios
<ul>
<li>SQL</li>
<li>Optimización</li>
</ul>
</li>
</ul>
<h2 id="overview-mer"><a class="header" href="#overview-mer">Overview MER</a></h2>
<p><strong>Todo DER</strong> tiene que tener claves y atributos, (a veces los vamos a
obviar).
El <strong>MER</strong> lo hacemos con <strong>D</strong>iagramas <strong>E</strong>ntidad <strong>R</strong>elación. Ahí tenemos:</p>
<ul>
<li>relaciones
<ul>
<li>unarias</li>
<li>binarias</li>
<li>ternarias</li>
</ul>
</li>
<li>cardinalidad: nro de elementos de una entidad que se relacionan con otro.
<ul>
<li>uno a uno</li>
<li>uno a muchos</li>
<li>muchos a muchos</li>
</ul>
</li>
<li>participación: cuántos elementos del conjunto pertenecen a la relación:
<ul>
<li>parcial: sólo una parte del conjunto está relacionado con algún otro.</li>
<li>total: todos están en algún elemento de la relación.</li>
</ul>
</li>
</ul>
<p>Ej:</p>
<pre class="mermaid">graph LR;
  B[se relaciona]-- 1 --&gt;A[Pelicula];
  B[se relaciona]-- N --&gt;C[Estudio];
</pre>
<ul>
<li>
<p>rol: el rol de una entidad en una relación.</p>
<ul>
<li>en una unaria es necesario agregarlo para evitar ambiguedades.</li>
<li>siempre tiene que haber una participación parcial</li>
</ul>
</li>
<li>
<p>Las únicas interrelaciones que admiten atributos son las M:N.</p>
<ul>
<li>Más de 1, 2 atributos no deberían haber. Pensar si esa relación no es mejor una entidad.</li>
<li>No debería tener que agregar un atributo identificador artificial</li>
</ul>
</li>
</ul>
<h3 id="ternarias"><a class="header" href="#ternarias">Ternarias</a></h3>
<ul>
<li>para leerlo tomo de a pares. ej:
<blockquote>
<p>Un instructor en un conjunto de semestres da varias materias</p>
</blockquote>
</li>
<li>se toman de a pares las entidades, y tiene que tener sentido que
para cada par de elementos de dos entidades tienen que estar
relacionado con uno del resto.
<ul>
<li>Ojo, es distinto a participación total/parcial</li>
</ul>
</li>
<li>binarias o ternarias?
<ul>
<li>Idealmente quiero el modelo más simple</li>
<li>Pero hay casos que binaria no alcanza. Ej:</li>
</ul>
<blockquote>
<p>José ensenó bases de datos en el 1er cuat de 1964. </p>
</blockquote>
<ul>
<li>Sin embargo, con una binaria puedo saber que:
<ul>
<li>José ensenó bases de datos</li>
<li>Bases de datos se dio en el 1er cuat de 1964</li>
<li>José ensenó en el 1er cuat de 1964</li>
</ul>
</li>
<li>... No puedo recuperar toda la info</li>
<li>cuando le meto la ternaria, me doy cuenta de que hay redundancia y puedo sacar las binarias</li>
</ul>
</li>
</ul>
<h3 id="jerarquías"><a class="header" href="#jerarquías">Jerarquías</a></h3>
<ul>
<li>Particiono con algún sentido una entidad
<ul>
<li>una entidad e1, e2 cumple que <code>es_un(e1, e2)</code> cuando es una subentidad de otra</li>
</ul>
</li>
<li><strong>HEREDAN</strong> la clave de la superentidad</li>
<li>cobertura
<ul>
<li>total, cuando cubro todo</li>
<li>parcial (marco con circulito en la superentidad como con las relaciones comunes)</li>
</ul>
</li>
<li>solapamiento
<ul>
<li>disjuntas (marco con una <code>d</code>)</li>
<li>con solapamiento</li>
</ul>
</li>
<li>pistas para subentidades:
<ul>
<li>una parte siempre se relaciona con algo y la otra no</li>
<li>una parte tiene un atributo que la otra no</li>
</ul>
</li>
<li>puedo armar varias jerarquías para una misma entidad</li>
</ul>
<pre class="mermaid">graph LR;
  A[Clase] --&gt; B( );
  B( ) -- tipo --&gt;C[Laboratorio];
  B( ) --&gt;D[Practica];
</pre>
<h3 id="agregación"><a class="header" href="#agregación">Agregación</a></h3>
<p>Supongamos por ejemplo, que tenemos docentes, materias y algunos
cursos realizan encuestas de evaluación docentes. Un docente dando una
materia puede no recibir encuestas, entonces no puedo usar una
ternaria. Y si la encuesta fuese obligatoria? Tampoco, porque no puedo
cargar al docente/materia hasta recibir la primer encuesta. </p>
<p>Con agregación, trato a una interrelación (junto a las entidades
vinculadas) como una entidad en sí mismo. <strong>Sólo es posible</strong> en relaciones <strong>M:N</strong></p>
<p>Hay un apunte sobre todo esto en el campus.</p>
<pre class="mermaid">graph TD;
  A--&gt;B;
  A--&gt;C;
</pre>
<h2 id="consideraciones-de-diseño"><a class="header" href="#consideraciones-de-diseño">Consideraciones de diseño</a></h2>
<ul>
<li>Respetar requerimientos</li>
<li>evitar redundancia</li>
<li>entidad o atributo? ej:</li>
</ul>
<pre class="mermaid">graph TD;
  A[Empleado];
  C[Cargo];
  N[Nombre];
  L[Nro Legajo];

  A --&gt; C;
  A --&gt; N;
  A --&gt; L;
</pre>
<ul>
<li>Entidad o interrelacion?
<ul>
<li>Muchos atributos?</li>
<li>Se complica la búsqueda de información?</li>
<li>Entidad débil
<ul>
<li>Una entidad que depende completamente de otra</li>
<li>La clave se forma con algún ID + la clave de la fuerte</li>
<li>Ej: items de una factura, asientos de un avión</li>
</ul>
</li>
</ul>
</li>
<li>Sustantivos en singular para entidades</li>
<li>Verbos para interrelaciones</li>
<li>de izquierda a derecha y arriba a abajo</li>
<li>replicar entidades (agregarles una marca para que se note que es la
misma entidad)</li>
<li>Elegir <strong>buenas claves</strong>
<ul>
<li>Inmutable</li>
<li>En muchos casos se genera una clave artificial (surrogateKey)</li>
</ul>
</li>
<li>Ojo con trampas
<ul>
<li>Fan traps
<ul>
<li>El camino entre entidades es ambiguo (suele pasar con varias <strong>1:N</strong>)</li>
</ul>
</li>
<li>Sink traps
<ul>
<li>Parece que hay una relación entre entidades pero en el camino se pierde.</li>
<li>Suele pasar cuando hay relaciones parciales.</li>
</ul>
</li>
<li>En el parcial, prestar atención a los requerimientos de las consultas.</li>
</ul>
</li>
<li>Las cosas importantes que no se pueden representar van a la sección de restricciones adicionales</li>
</ul>
<h2 id="ejercicios"><a class="header" href="#ejercicios">Ejercicios</a></h2>
<h3 id="ejercicio-1"><a class="header" href="#ejercicio-1">Ejercicio 1</a></h3>
<p>Casa de subastas quiere registrar las transacciones que realiza.</p>
<ul>
<li>Los productos se agrupan en lotes (nro catálogo, descripción, precio
de salida).</li>
<li>Para cada producto se almacena el código de producto, nombre,
descripción y foto.</li>
<li>Los clientes(código, nombre, apellido, dni, mail) hacen pujas
(fecha/hora, monto)</li>
</ul>
<pre class="mermaid">graph LR;
  C[Cliente];
  P[Producto];
  L[Lote];

  H[Hace una Puja];
  PL[Pertenece a un];

  C --&gt; Z1[**codigo**]
  C --&gt; Z2[nombre]
  C --&gt; Z3[dni]
  C --&gt; Z4[mail]

  P --&gt; X1[**codigo**]
  P --&gt; X2[descr.]
  P --&gt; X3[nombre]
  P --&gt; X4[foto]

  L --&gt; Y1[**nro catalogo**]
  L --&gt; Y2[descr.]
  L --&gt; Y3[precio]

  P -- N --&gt; PL 
  L -- 1 --&gt; PL

  C -- M --&gt; H;
  L -- N --&gt; H;

  H --&gt; FH[fecha/hora]
  H --&gt; MON[Monto]
</pre>
<ul>
<li>
<p>Hay productos que no están asociados a ningún lote (part. parcial)</p>
</li>
<li>
<p>En este modelo, el cliente sólo puede pujar una vez. Para
solucionarlo puedo:</p>
<ul>
<li>Marcar como clave la fecha y hora</li>
<li>Hacer una puja como entidad
<ul>
<li>Variante: Puja es una entidad débil con clave fecha/hora
<ul>
<li>No puedo meterlo directo como clave porque puedo tener varios
clientes pujando al mismo tiempo en salas distintas.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>No confundir: no me sale modelar esto con agrego restricciones porque posta no se puede expresar en el der</p>
</li>
</ul>
<h3 id="ejercicio-2"><a class="header" href="#ejercicio-2">Ejercicio 2</a></h3>
<p>Atributos modelo y marca pasarlos a entidades, y ojo con cómo armo las
interrelaciones (tiene que ser auto &lt;-&gt; modelo &lt;-&gt; marca)</p>
<ul>
<li>No busquen cosas que no hay, o sea leer bien todo el enunciado y no
buscar entidades débiles, relaciones ternarias, agregaciones, etc.</li>
</ul>
<h3 id="ejercicio-3"><a class="header" href="#ejercicio-3">Ejercicio 3</a></h3>
<ul>
<li>domicilio asumo que no hay drama</li>
<li>provincias son pocas así que las puedo hacer como tabla</li>
<li>pregunta: armo una jerarquía con médico y paciente? <strong>NO</strong> Pensar,
qué sería el <code>es_un</code>? mamífero?</li>
<li>el ingreso no sería una entidad débil? No, porque en el enunciado aclara que tienen un código autoincremental</li>
</ul>
<h3 id="ejercicio-4"><a class="header" href="#ejercicio-4">Ejercicio 4</a></h3>
<p>No lo llegamos a ver en clase, pero un poco la idea va de que tengo 3
entidades:</p>
<ul>
<li>Operario</li>
<li>Tarea</li>
<li>Inspector</li>
</ul>
<p>Inicialmente podría pensar que un Operario realiza Tareas y cada tarea
puede tener varios Inspectores. Si los inspectores revisan a todos los
operarios que están haciendo esa tarea entonces estamos ok. Pero si el
inspector evalúa al operario que está haciendo esa tarea entonces no
nos alcanza, pues estaríamos cayendo en la trampa del abanico.</p>
<p>En ese segundo caso, una solución sería una ternaria entre operario,
inspector y tarea, no? <strong>NO</strong>, porque no necesariamente voy a tener
inspectores en todos los operarios que hagan tareas. Es por eso que en
este caso podemos usar una agregación que relaciona al operario
haciendo una tarea con los inspectores.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="guías-de-ejercicios"><a class="header" href="#guías-de-ejercicios">Guías de Ejercicios</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="guía-de-ejercicios-1"><a class="header" href="#guía-de-ejercicios-1">Guía de Ejercicios 1</a></h1>
<h2 id="ejercicios-introductorios"><a class="header" href="#ejercicios-introductorios">Ejercicios Introductorios</a></h2>
<h3 id="ejercicio-1-1"><a class="header" href="#ejercicio-1-1">Ejercicio 1</a></h3>
<h3 id="ejercicio-2-1"><a class="header" href="#ejercicio-2-1">Ejercicio 2</a></h3>
<h3 id="ejercicio-3-1"><a class="header" href="#ejercicio-3-1">Ejercicio 3</a></h3>
<h3 id="ejercicio-4-1"><a class="header" href="#ejercicio-4-1">Ejercicio 4</a></h3>
<h3 id="ejercicio-5"><a class="header" href="#ejercicio-5">Ejercicio 5</a></h3>
<h3 id="ejercicio-6"><a class="header" href="#ejercicio-6">Ejercicio 6</a></h3>
<h3 id="ejercicio-7"><a class="header" href="#ejercicio-7">Ejercicio 7</a></h3>
<h2 id="ejercicios-avanzados"><a class="header" href="#ejercicios-avanzados">Ejercicios Avanzados</a></h2>
<h3 id="ejercicio-1-2"><a class="header" href="#ejercicio-1-2">Ejercicio 1</a></h3>
<h3 id="ejercicio-2-2"><a class="header" href="#ejercicio-2-2">Ejercicio 2</a></h3>
<h3 id="ejercicio-3-2"><a class="header" href="#ejercicio-3-2">Ejercicio 3</a></h3>
<h3 id="ejercicio-4-2"><a class="header" href="#ejercicio-4-2">Ejercicio 4</a></h3>
<h3 id="ejercicio-5-1"><a class="header" href="#ejercicio-5-1">Ejercicio 5</a></h3>
<h3 id="ejercicio-6-1"><a class="header" href="#ejercicio-6-1">Ejercicio 6</a></h3>
<h3 id="ejercicio-7-1"><a class="header" href="#ejercicio-7-1">Ejercicio 7</a></h3>
<h3 id="ejercicio-8"><a class="header" href="#ejercicio-8">Ejercicio 8</a></h3>
<div style="break-before: page; page-break-before: always;"></div><h1 id="contributors"><a class="header" href="#contributors">Contributors</a></h1>
<ul>
<li><a href="https://github.com/mFragaBA">mFragaBA</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="mermaid.min.js"></script>
        <script type="text/javascript" src="mermaid-init.js"></script>
        <script type="text/javascript">
        window.addEventListener('load', function() {
            MathJax.Hub.Register.StartupHook('End', function() {
                window.setTimeout(window.print, 100);
            });
        });
        </script>
    </body>
</html>
